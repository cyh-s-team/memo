---
title: 随心记——基于AndroidStudio的记事类app
author:
  - 陈宇航(1912190514)

description: |
  我们开发了一个基于AndroidStudio的记事类app，
  它前端采用AndroidStudio，后端采用django，
  实现了新增日记、日记密码锁、日记提醒、日记搜索以及公开热门日记圈子等功能
---

文档可以使用markdown编写，用[Pandoc](https://pandoc.org/)转成PDF、html或者word等格式。

# 一、项目介绍 [陈宇航]

## 背景

在现代，生活节奏不断加快，人们为了生活中的种种事情而疲于奔命，有些人辛苦了一整天，第二天回想起来这一天的时候，却什么都记不起来。因此，我们的项目“随心记”就由此产生，它帮助人们在有空时，用文字和图片将自己生活中的碎片整理起来，就像是小时候那本珍爱的日记本。用户可以为自己的日记设置密码、提醒以及是否公开，当想回忆日记内容时候可以按日期、关键字进行搜索。同时，那些公开的日记形成了一个日记圈，用户可以在里面找到和自己兴趣相投的用户。

## 项目需求分析

1.项目定位：

随心记项目主要定位于那些有写日记习惯的人群，为他们提供了一个简洁高效的软件去完成自己记日记的需求，同时可以对日记进行上锁、提醒、搜索等操作，如果愿意将自己的生活碎片分享给大众，可以将自己的日记设为公开，分享到热门日记圈子里，来满足部分对社交有需求的用户群体。

2.项目需求汇总：

| 序号 |                      使用场景                      |          需求提炼          |  对应功能  | 需求类型 |
| :--: | :------------------------------------------------: | :------------------------: | :--------: | :------: |
|  1   | 有记手账、写日记习惯的人群，但不能将记事本随身携带 |  需要一款能用来记事的APP   |    日记    |   基本   |
|  2   |   希望将自己的生活分享给别人，找到兴趣相投的朋友   |  可以将生活点滴分享给他人  |  日记圈子  |   基本   |
|  3   |             希望打造自我空间，增加隐私             |        日记私密上传        |   密码锁   |   基本   |
|  4   |        时常会忘记生活中的琐事，可以提醒用户        |    在设定的时间提醒用户    |  定时提醒  |   基本   |
|  5   |            喜欢定期整理自己过往生活碎片            | 搜索一段时间内自己写的日记 | 按时间搜索 |   基本   |
|  6   |             希望首页推荐看上去舒适直观             |         卡片式布局         |  排版优化  |   期望   |

3.项目功能结构：

![image-20220609092242555](C:\Users\69165\AppData\Roaming\Typora\typora-user-images\image-20220609092242555.png)

4.功能需求清单：

| 需求分类   |                  | 需求说明                                                  | 优先级 |
| ---------- | ---------------- | --------------------------------------------------------- | ------ |
| 登录界面   | 已登录状态       | 用户可以进行APP内所有操作                                 | 高     |
|            | 未登录状态       | 用户仅可以浏览页面                                        | 高     |
|            | 帐号注册         | 用户填写ID、用户名、密码进行注册                          | 高     |
|            | 帐号登录         | 用户输入用户名和密码进行登录                              | 高     |
|            | 忘记密码         | 系统根据ID和用户名确定用户身份                            | 高     |
| 日记主页面 | 新建日记         | 用户输入日记标题和日记内容                                | 高     |
|            | 查看日记详情     | 系统显示详细日记标题和日记内容                            | 高     |
|            | 编辑日记         | 用户修改日记标题和日记内容                                | 高     |
|            | 删除日记         | 用户可以选择日记进行删除                                  | 高     |
|            | 上锁日记         | 用户选择日记，设置密码进行上锁                            | 高     |
|            | 解锁日记         | 用户填写密码对日记解锁                                    | 高     |
|            | 按日期搜索日记   | 用户选择日期搜索，<br />系统显示对应时间段的日记          | 中     |
|            | 按关键字搜索日记 | 用户输入关键字搜索，<br />系统显示含有关键字的日记        | 中     |
|            | 按时提醒         | 用户设置提醒时间，<br />系统在设定的时间提醒用户          | 中     |
| 日记圈页面 | 点赞日记         | 用户对日记进行点赞                                        | 中     |
|            | 评论日记         | 用户对日记进行评论                                        | 中     |
|            | 查看热门日记详情 | 用户查看热门的详情                                        | 中     |
|            | 查看用户详情     | 用户点击查看他人详情                                      | 中     |
|            | 关注用户         | 用户点击关注他人                                          | 中     |
| 个人页面   | 创建个人详情资料 | 用户首次登录APP，输入姓名、<br />签名、头像、性别创建资料 | 高     |
|            | 编辑个人详情资料 | 用户修改个人详情资料                                      | 高     |
|            | 查看关注列表     | 用户点击查看关注的人                                      | 低     |
|            | 查看粉丝列表     | 用户点击查看自己的粉丝                                    | 低     |
|            | 查看点赞列表     | 用户点击查看自己点赞过的日记                              | 低     |
|            | 查看评论列表     | 用户点击查看自己评论过的日记                              | 低     |
|            |                  |                                                           |        |



## 计划和分工

介绍大致的开发计划以及每个人的分工。

陈宇航：前端用户登录模块、日记模块、个人详情模块的功能实现和原型设计，后端全部内容，数据表设计，APIFox设计，后端测试



# 二、界面原型设计 [陈宇航]

根据前面的功能需求分析，分模块介绍每部分的原型设计。包括界面的具体细节、跳转关系以及实现说明等。

此部分应按照模块来进行组织，比如第一部分用户管理，其中包含了用户登录、注册、信息查看、修改等等，把这部分的界面设计及跳转关系统一放在一张图上。

除了设计图之外，应该用语言详细说明自己的设计理念，为什么要这么设计，有什么优缺点，实现的难度如何等等。

一.登录界面

二.主页面

三.日记主页面

四.新增日记页面

四.日记圈子页面

五.个人详情页面

# 三、系统架构设计 [李四]

这部分主要是对系统各部分的架构设计，和前面界面设计不同，这部分侧重于功能设计。

架构设计应按照从总体到局部、从粗到细的顺序分小节进行描述。

首先，描述系统的整体架构，包括前端、后端、API、数据库、消息队列等各个部分的大致结构，可用示意图来进行描述，并详细说明每部分的具体作用，以及为什么这么设计，其优缺点是什么。

然后，分小节分别介绍各个部分。比如前端包含什么模块，这些模块的关系如何，这些模块为什么这么设计，优缺点是什么。后端等也是如此。

最后，对每个模块给出实现的方案，比如采用什么框架、什么技术来实现。

1.系统整体架构

2.前端架构

3.后端架构

4.方案实现

前端：AndroidStudio

后端：Django

数据库：ORM+SQLLite

原型设计：墨刀UI

接口设计：APIfox



# 四、API设计 [陈宇航]

该处我选择直接用APIfox生成接口文档，便于更加直观的说明API的设计理念，使用以及响应数据。

APIfox在线分享链接：https://www.apifox.cn/apidoc/shared-bd557f21-16d7-49ca-b0ba-9237b20a0374



# 五、数据库设计 [陈宇航]

这部分主要是数据库方面的设计。

首先，详细描述自己系统中需要持久化的数据以及需要缓存的数据等，根据数据的特点确定自己的数据库方案（采用什么数据库及其原因）。

其次，结合ER图、列表等对自己的数据库中的数据进行详细描述，都有哪些表，保存了哪些数据，为什么要这么设计。

最后，详细描述所使用的数据库相关技术，比如ORM、工具以及具体的使用方式。



1.系统数据分析

从用户模块出发，这一块为避免重复注册，应设计一个主键id，同时设计用户名和密码，用于登录、找回密码等操作；

在日记模块方面，日记本身主要由标题、内容、创建时间构成，但还包括了日记是否上锁（若上锁密码是多少），日记是否设置了提醒（若设置了提醒时间是多少），日记是否公开（公开的评论列表和点赞列表等信息）等信息，但这类信息全都放在日记表中太过冗余，因此我选择建立上锁表、提醒表、评论表、点赞表、关注表，将对应的信息通过id串联起来，例如上锁表中的主键上锁id和日记id始终保持一致，双方有一处变化了，另一处也会变化。

最后的个人详情模块，通过用户表中的用户id和个人id相关联，来确保一个用户id对应一个个人id。

综上数据分析，再结合所使用的后端框架django，我决定使用的数据库技术是SQLLite+ORM，用软件本身自带的数据库，优点是便于合作时可以直接运行，减少配置环境的麻烦。

2.数据表设计

（1）整体ER图

（2）用户表

|   名称    |  类型  | 必填 |     说明     |
| :-------: | :----: | :--: | :----------: |
| » userid  | string |  是  | 用户id(主键) |
| » usename | string |  是  |    用户名    |
| » passwd  | string |  是  |   用户密码   |

（3）日记表

|    名称    |  类型   | 必填 |                             说明                             |
| :--------: | :-----: | :--: | :----------------------------------------------------------: |
| » diaryid  | integer |  是  |                        日记id（主键）                        |
|  » title   | string  |  是  |                           日记标题                           |
| » content  | string  |  是  |                           日记内容                           |
| » ifremind | integer |  否  |  是否设置了日记提醒<br />0代表没有设置提醒，1代表设置了提醒  |
|  » iflock  | integer |  否  | 是否设置了日记密码<br />0代表没有设置日记密码，1代表设置了日记密码 |
| » ifpubilc | integer |  否  |           日记是否公开<br />0代表不公开，1代表公开           |
|    time    |  date   |  是  |                         日记创建时间                         |

（4）上锁表（日记密码表）

|     名称     |  类型   | 必填 |                   说明                   |
| :----------: | :-----: | :--: | :--------------------------------------: |
|   » lockid   | integer |  是  | 上锁id（主键）<br />与日记id始终保持一致 |
| » lockpasswd | string  |  是  |                 日记密码                 |

（5）日记提醒表（日记闹钟表）

|     名称     |  类型   | 必填 |               说明               |
| :----------: | :-----: | :--: | :------------------------------: |
|  » remindid  | integer |  是  | 提醒id<br />与日记id始终保持一致 |
| » remindtime | string  |  是  |             提醒时间             |

(6)日记评论表

|       名称       |  类型   | 必填 |        说明        |
| :--------------: | :-----: | :--: | :----------------: |
|   » personid1    | integer |  是  |  评论人id（主动）  |
|   » personid2    | integer |  是  | 被评论人id（被动） |
|    » diaryid     | integer |  是  |       日记id       |
| » commentcontent | string  |  是  |    日记评论内容    |
|  » commenttime   |  date   |  是  |    日记评论时间    |

（7）日记点赞表

|    名称     |  类型   | 必填 |        说明        |
| :---------: | :-----: | :--: | :----------------: |
| » personid1 | integer |  是  |  点赞人id（主动）  |
| » personid2 | integer |  是  | 被点赞人id（被动） |
|  » diaryid  | string  |  是  |       日记id       |
| » liketime  |  date   |  是  |      点赞时间      |

（8）关注列表

|    名称     | 位置 |  类型   | 必填 |        说明        |
| :---------: | :--: | :-----: | :--: | :----------------: |
| » personid1 | body | integer |  是  |  关注人id（主动）  |
| » personid2 | body | integer |  是  | 被关注人id（被动） |

(9)个人详情表

|    名称    |  类型   | 必填 |                 说明                 |
| :--------: | :-----: | :--: | :----------------------------------: |
|  personid  | integer |  是  | 个人id（主键）<br />和用户id保持一致 |
| personname | string  |  是  |               个人姓名               |
| personsign | string  |  是  |               个性签名               |
|  likenum   | integer |  否  |               点赞数量               |
| follownum  | integer |  否  |               关注数量               |
|  fansnum   | integer |  否  |               粉丝数量               |
| commentnum | integer |  否  |               评论数量               |

3.数据库相关技术

由于项目使用的是django后端，因此主要用的数据库技术是ORM

3.1ORM介绍：

ORM，全称Object Relational Mapping，中文叫做对象关系映射，通过ORM我们可以通过类的方式去操作数据库，而不用再写原生的SQL语句。通过把表映射成类，把行作实例，把字段作为属性，ORM在执行对象操作的时候最终还是会把对应的操作转换为数据库原生语句。

3.2ORM使用流程：

（1）settings配置数据库，位置在databases字典内，配置项包括引擎，数据库名称，地址，端口号，用户名，密码，这些需要自己写键和键值的

（2）models：在一个APP内部的models内创建模型

![image-20220608202606345](C:\Users\69165\AppData\Roaming\Typora\typora-user-images\image-20220608202606345.png)

![image-20220608202623287](C:\Users\69165\AppData\Roaming\Typora\typora-user-images\image-20220608202623287.png)



（3）在settings内注册APP，在INSTALLED_APPS内注册（添加）

![image-20220608202642719](C:\Users\69165\AppData\Roaming\Typora\typora-user-images\image-20220608202642719.png)（4）生成迁移文件：python manage.py makemigrations
（5）迁移数据库：python manage.py migrate
（6)可以在sqlyog中看到数据库了

![image-20220608202724232](C:\Users\69165\AppData\Roaming\Typora\typora-user-images\image-20220608202724232.png)

（7)在views内定义相关的增删改查操作

![image-20220608202744344](C:\Users\69165\AppData\Roaming\Typora\typora-user-images\image-20220608202744344.png)

![image-20220608202457443](C:\Users\69165\AppData\Roaming\Typora\typora-user-images\image-20220608202457443.png

# 六、AndroidStudio前端的实现 [王]

这部分分模块来描述前端的具体实现，比如：

## 6.1 用户管理的实现

这部分是用户管理模块，如登录、注册、修改等功能的具体实现。这里应该重点将实现时考虑的因素，使用的算法以及这样做的优缺点，最后可以通过界面的截图来展示实现效果。

## 6.2 点名功能的实现

这部分主要讲点名功能的具体实现方案，可以通过用例图、流程图等来辅助说明。并通过截图来展示效果。

实现部分不要只有截图，要有文字说明，讲讲这部分实现时采用什么技术，优缺点是什么，实现难点在哪里。


# 七、django后端的实现[陈宇航]

这部分也是分模块来展示后端的实现方案。具体参见前面第六部分。

## 7.1后端模块总览

## 7.1用户管理模块的实现

## 7.2日记模块的实现

## 7.3热门日记圈模块的实现

## 7.4个人详情页面模块的实现

# 八、系统测试[陈宇航]

这部分主要讲系统的测试方案，不要简单贴图，要写出具体的自动测试方案。可以前后端分开来写。

## 8.1 单元测试

这部分是单元测试的方案，可以列表统计有多少测试，覆盖率是多少。

## 8.2 集成测试

## 8.3 测试部署及结果

这部分可以先如何部署到GitHub或其它系统，如何在开发时利用测试来保证正确率的，测试结果如何。

整个系统的后端测试，我主要部署在了GitHub上，利用自带的git action，在每一次提交后端代码时，都会自动的进行测试，来确保代码的正确率。

（1）git action部署文件：如下图是对git action的环境进行部署，主要的关键点在于要将requirements文件放在和workflow同一个目录下，同时执行test测试的路径要对，例如我这里的 python django/memodjango/manage.py test 命令

![image-20220608200529525](C:\Users\69165\AppData\Roaming\Typora\typora-user-images\image-20220608200529525.png)

（2）测试核心：

对于测试，我认为主要有两类：一类是必定成功的，例如查看点赞列表、评论列表之类的接口，对于这类接口，主要是对返回的数据加以验证，如下图（以获取点赞列表为例）：

对于这部分接口逻辑，我将得到的数据在终端进行打印，通过和数据库中的数据进行对比，来校验数据是否有误，数据格式是否符合标准

![image-20220608201419089](C:\Users\69165\AppData\Roaming\Typora\typora-user-images\image-20220608201419089.png)



![image-20220608201530547](C:\Users\69165\AppData\Roaming\Typora\typora-user-images\image-20220608201530547.png)

而另一类接口，例如登录、注册之类的接口，它们是可能由于用户名密码错误等问题不成功的，那么为了让前端知道为什么，这类接口需要写正反两个例子（成功和失败），如下图（以用户登录为例）：

![image-20220608201759344](C:\Users\69165\AppData\Roaming\Typora\typora-user-images\image-20220608201759344.png)

![image-20220608201817525](C:\Users\69165\AppData\Roaming\Typora\typora-user-images\image-20220608201817525.png)

（3）测试结果：

由于我一般会在pycharm上先用python manage.py test命令进行测试，因此提交到GitHub上通过git action进行

测试的正确率基本为100%，见下图（部分展示，具体可见GitHub上的aciton页面）：

![image-20220608201031493](C:\Users\69165\AppData\Roaming\Typora\typora-user-images\image-20220608201031493.png)


# 九、系统部署 [王五]

这部分主要写系统的部署方案，采用了什么样的部署方案（docker？虚拟机？云平台？），有没有自动部署等方案以及具体的步骤和使用方法。

# 十、功能展示 [张三、李四、王五]

基本的功能展示，可以用视频来展示。如果贴图，请尽量将相同模块的图拼接在一起以减少空间占用。

# 十一、清单 [张三、李四、王五]

这部分列出项目提交的清单，如：

- 前端代码: wx_class项目
- 后端代码: class_backend项目
- 原型设计文件: docs/design目录
- 项目演示视频: docs/videos目录
- ……

# 十二、总结 [张三、李四、王五]

项目的总结，整个项目的感受以及下一步的计划。

# 十二、参考文献 [张三、李四、王五]

系统所参考的文献或者代码，比如：

- Flask: https://flask.palletsprojects.com/
- uni-app: https://uniapp.dcloud.io/ 
